name: "python-executor"
mode: ONCE
hostname: "executor"
cwd: "/tmp"

time_limit: 15
rlimit_as: 700
rlimit_cpu: 10
rlimit_nofile: 128
rlimit_fsize: 1024
rlimit_nproc: 64

# Full namespace isolation for local execution
clone_newnet: true
clone_newuser: false
clone_newns: true
clone_newpid: true
clone_newipc: true
clone_newuts: true
clone_newcgroup: false

# Read-only root filesystem
mount {
    src: "/"
    dst: "/"
    is_bind: true
    rw: false
}

# /proc filesystem
mount {
    dst: "/proc"
    fstype: "proc"
    rw: false
}

# Writable /tmp (isolated)
mount {
    src: "/tmp/nsjail"
    dst: "/tmp"
    is_bind: true
    rw: true
}

# Essential devices
mount { src: "/dev/null" dst: "/dev/null" rw: true is_bind: true }
mount { src: "/dev/zero" dst: "/dev/zero" rw: false is_bind: true }
mount { src: "/dev/urandom" dst: "/dev/urandom" rw: false is_bind: true }

# Python binary
mount { src: "/usr/local/bin/python3" dst: "/usr/local/bin/python3" is_bind: true rw: false }